[["index.html", "Statistical Modeling Chapter 1 Prerequisites", " Statistical Modeling Benjamin Buchwitz 2021-01-10 Chapter 1 Prerequisites This repo contains course materials. "],["factor-analysis.html", "Chapter 2 Factor Analysis 2.1 Foundations 2.2 Basic Example 2.3 Basic Factor Analysis in R Exercises", " Chapter 2 Factor Analysis Statistically speaking the main goal of factor analysis is to describe the covariance structure among many variables in terms of a few underlying, but unobservable random quantities, called factors. This usually happens by assuming that the supposed variables can be organized into (contextually meaningful) groups. The variables in a given group are assumed to be highly correlated and thus represent or are related to a latent construct. While the correlation within a group of variables is high, the correlation between different groups is expected to be low. Following that argumentation it should be possible to condense the information from multiple observed variables within a group into a single unobserved factor variable. While Explanatory Factor Analysis (EFA) aims at finding the mentioned groups Confirmatory Factor Analysis (CFA) aims at confirming an a priori hypothesized variable grouping constellation. While EFA and CFA serve different purposes when doing research, their foundation meaning the model formulation, the estimation and the derivation of quantities of interest follows the same scheme, which will be presented below. 2.1 Foundations \\[ X_1 - \\mu_1 = l_{11} F_1 + l_{12} F_2 + \\ldots + l_{1m} F_m + \\epsilon_1 \\\\ X_2 - \\mu_2 = l_{21} F_1 + l_{22} F_2 + \\ldots + l_{2m} F_m + \\epsilon_2 \\\\ \\vdots \\\\ X_p - \\mu_p = l_{p1} F_1 + l_{p2} F_2 + \\ldots + l_{pm} F_m + \\epsilon_p \\] Although the equations above seem to be related to multiple regression equations the fact that all quantities on the right hand side are unobseved (in fact only \\(X\\) is observed) distinguishes this factor model from regression problems. The factor analysis model can also be written in matrix notation, which allows for easier derivation of some of the following procedures and thus should be considered valuable as well. \\[ \\underset{p \\times 1}{\\boldsymbol X - \\boldsymbol \\mu} = \\underset{p \\times m}{\\boldsymbol L} \\; \\underset{m \\times p}{\\boldsymbol F} + \\underset{p \\times 1}{\\boldsymbol \\epsilon} \\] \\[ \\boldsymbol \\Sigma = Cov(\\boldsymbol X) = \\underset{\\;\\\\Communality}{\\boldsymbol L \\boldsymbol L^T} + \\underset{\\;\\\\Uniqueness}{\\boldsymbol \\Psi} \\] ## Estimation 2.2 Basic Example ski &lt;- data.frame(skiers = paste0(&quot;S&quot;, c(1:5)), cost = c(32, 61, 59, 36, 62), lift = c(64, 37, 40, 62, 46), depth = c(65, 62, 45, 34, 43), powder = c(67, 65, 43, 35, 40)) R &lt;- cor(ski[ ,-1]) # Calculating correlation Matrix V &lt;- eigen(R)$values # Calculating eigenvalues V ## [1] 2.016305104 1.941513814 0.037812306 0.004368776 Remember that the Eigenvalue-Decomposition \\[ R = V L V^T\\] Reconstructing the correlation Matrix with given Eigenvalues and eigenvectors eigen(R)$vectors %*% diag(eigen(R)$values) %*% t(eigen(R)$vectors) ## [,1] [,2] [,3] [,4] ## [1,] 1.00000000 -0.95299048 -0.05527555 -0.12999882 ## [2,] -0.95299048 1.00000000 -0.09110654 -0.03624823 ## [3,] -0.05527555 -0.09110654 1.00000000 0.99017435 ## [4,] -0.12999882 -0.03624823 0.99017435 1.00000000 Manual Scree plot 2.3 Basic Factor Analysis in R 2.3.1 Data Description d &lt;- readRDS(&quot;data/big5_responses_DE.rds&quot;) d &lt;- na.omit(d) questionnaire &lt;- d[,26:35] 2.3.2 The factanal() Function 2.3.3 Selecting numbers of Factors # Calculate Correlation Matrix, Eigenvalues &amp; Proportion of Variance R &lt;- cor(questionnaire) eigval &lt;- eigen(R)$values proptotvar &lt;- eigval / sum(eigval) # Screeplot plot(eigval, type = &quot;b&quot;, ylab = &quot;Eigenvalue&quot;, xlab=&quot;Index&quot;, xaxt=&quot;n&quot;) axis(1, at=1:length(eigval)) abline(h=1, lty = &quot;dotted&quot;, col=&quot;red&quot;) df &lt;- data.frame(Eigenvalue = eigval, Var=proptotvar, sumVar=cumsum(proptotvar)) knitr::kable(df, digits=4, booktabs=T) Eigenvalue Var sumVar 2.4352 0.2435 0.2435 2.1824 0.2182 0.4618 0.9201 0.0920 0.5538 0.8081 0.0808 0.6346 0.7554 0.0755 0.7101 0.7017 0.0702 0.7803 0.6111 0.0611 0.8414 0.5802 0.0580 0.8994 0.5184 0.0518 0.9513 0.4875 0.0487 1.0000 2.3.4 Applying Factor Analysis fa_none &lt;- factanal(questionnaire , factors = 2, rotation = &quot;none&quot;) fa_varimax &lt;- factanal(questionnaire , factors = 2, rotation = &quot;varimax&quot;) fa_promax &lt;- factanal(questionnaire, factors = 2, rotation = &quot;promax&quot;) par(mfrow = c(1,3)) plot(fa_none$loadings[,1], fa_none$loadings[,2], xlab = &quot;Factor 1&quot;, ylab = &quot;Factor 2&quot;, ylim = c(-1,1), xlim = c(-1,1), main = &quot;No rotation&quot;) abline(h = 0, v = 0, col=&quot;darkgrey&quot;) plot(fa_varimax$loadings[,1], fa_varimax$loadings[,2], xlab = &quot;Factor 1&quot;, ylab = &quot;Factor 2&quot;, ylim = c(-1,1), xlim = c(-1,1), main = &quot;Varimax rotation&quot;) text(fa_varimax$loadings[,1]-0.08, fa_varimax$loadings[,2]+0.08, colnames(questionnaire), col=&quot;blue&quot;) abline(h = 0, v = 0, col=&quot;darkgrey&quot;) plot(fa_promax$loadings[,1], fa_promax$loadings[,2], xlab = &quot;Factor 1&quot;, ylab = &quot;Factor 2&quot;, ylim = c(-1,1), xlim = c(-1,1), main = &quot;Promax rotation&quot;) abline(h = 0, v = 0, col=&quot;darkgrey&quot;) 2.3.5 Interpreting the Factors Exercises "],["system-info.html", "Chapter 3 System Info", " Chapter 3 System Info sessionInfo() ## R version 4.0.3 (2020-10-10) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Catalina 10.15.7 ## ## Matrix products: default ## BLAS: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib ## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib ## ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] kableExtra_1.3.1 knitr_1.30 ## ## loaded via a namespace (and not attached): ## [1] rstudioapi_0.13 xml2_1.3.2 magrittr_2.0.1 rvest_0.3.6 ## [5] munsell_0.5.0 colorspace_2.0-0 viridisLite_0.3.0 R6_2.5.0 ## [9] rlang_0.4.10 stringr_1.4.0 httr_1.4.2 highr_0.8 ## [13] tools_4.0.3 webshot_0.5.2 xfun_0.20 htmltools_0.5.0 ## [17] yaml_2.2.1 digest_0.6.27 lifecycle_0.2.0 bookdown_0.21 ## [21] glue_1.4.2 evaluate_0.14 rmarkdown_2.6 stringi_1.5.3 ## [25] compiler_4.0.3 scales_1.1.1 "]]
