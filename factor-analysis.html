<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Factor Analysis | Statistical Modeling</title>
  <meta name="description" content="Chapter 2 Factor Analysis | Statistical Modeling Course Notes" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Factor Analysis | Statistical Modeling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 2 Factor Analysis | Statistical Modeling Course Notes" />
  <meta name="github-repo" content="bchwtz/bchwtz-smod" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Factor Analysis | Statistical Modeling" />
  
  <meta name="twitter:description" content="Chapter 2 Factor Analysis | Statistical Modeling Course Notes" />
  

<meta name="author" content="Benjamin Buchwitz" />


<meta name="date" content="2021-01-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="system-info.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><b>Statistical Modeling</b></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>2</b> Factor Analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="factor-analysis.html"><a href="factor-analysis.html#foundations"><i class="fa fa-check"></i><b>2.1</b> Foundations</a></li>
<li class="chapter" data-level="2.2" data-path="factor-analysis.html"><a href="factor-analysis.html#estimation"><i class="fa fa-check"></i><b>2.2</b> Estimation</a><ul>
<li class="chapter" data-level="2.2.1" data-path="factor-analysis.html"><a href="factor-analysis.html#principal-component-method"><i class="fa fa-check"></i><b>2.2.1</b> Principal Component Method</a></li>
<li class="chapter" data-level="2.2.2" data-path="factor-analysis.html"><a href="factor-analysis.html#principal-factor-solution"><i class="fa fa-check"></i><b>2.2.2</b> Principal Factor Solution</a></li>
<li class="chapter" data-level="2.2.3" data-path="factor-analysis.html"><a href="factor-analysis.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>2.2.3</b> Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="factor-analysis.html"><a href="factor-analysis.html#rotation"><i class="fa fa-check"></i><b>2.3</b> Rotation</a></li>
<li class="chapter" data-level="2.4" data-path="factor-analysis.html"><a href="factor-analysis.html#basic-factor-analysis-in-r"><i class="fa fa-check"></i><b>2.4</b> Basic Factor Analysis in R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="factor-analysis.html"><a href="factor-analysis.html#data-preparation-and-description"><i class="fa fa-check"></i><b>2.4.1</b> Data Preparation and Description</a></li>
<li class="chapter" data-level="2.4.2" data-path="factor-analysis.html"><a href="factor-analysis.html#selecting-numbers-of-factors"><i class="fa fa-check"></i><b>2.4.2</b> Selecting numbers of Factors</a></li>
<li class="chapter" data-level="2.4.3" data-path="factor-analysis.html"><a href="factor-analysis.html#applying-factor-analysis"><i class="fa fa-check"></i><b>2.4.3</b> Applying Factor Analysis</a></li>
<li class="chapter" data-level="2.4.4" data-path="factor-analysis.html"><a href="factor-analysis.html#interpreting-the-factors"><i class="fa fa-check"></i><b>2.4.4</b> Interpreting the Factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="factor-analysis.html"><a href="factor-analysis.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="part"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="3" data-path="system-info.html"><a href="system-info.html"><i class="fa fa-check"></i><b>3</b> System Info</a></li>
<li class="divider"></li>
<li><a href="http://www.bchwtz.de" target="blank"><center>www.<b>BCHWTZ</b>.de</center></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modeling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="factor-analysis" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Factor Analysis</h1>
<p>Statistically speaking the main goal of factor analysis is to describe the covariance structure among many variables in terms of a few underlying, but unobservable random quantities, called factors. This usually happens by assuming that the supposed variables can be organized into (contextually meaningful) groups. The variables in a given group are assumed to be highly correlated and thus represent or are related to a latent construct. While the correlation within a group of variables is high, the correlation between different groups should be low. Following that argumentation it may be possible to condense the information from multiple observed variables within a group into a single unobserved factor variable. While Explanatory Factor Analysis (EFA) aims at finding the mentioned groups Confirmatory Factor Analysis (CFA) aims at confirming an <em>a priori</em> hypothesized variable grouping constellation.</p>
<p>While EFA and CFA serve different purposes when doing research, their foundation, especially the model formulation, the estimation and the derivation of quantities of interest is highly comparable and will be presented below.</p>
<div id="foundations" class="section level2">
<h2><span class="header-section-number">2.1</span> Foundations</h2>
<p><span class="math display">\[
X_1 - \mu_1 = l_{11} F_1 + l_{12} F_2 + \ldots + l_{1m} F_m + \epsilon_1 \\
X_2 - \mu_2 = l_{21} F_1 + l_{22} F_2 + \ldots + l_{2m} F_m + \epsilon_2 \\
\vdots \\
X_p - \mu_p = l_{p1} F_1 + l_{p2} F_2 + \ldots + l_{pm} F_m + \epsilon_p
\]</span>
Although the equations above seem to be related to multiple regression equations the fact that all quantities on the right hand side are unobseved (in fact only <span class="math inline">\(X\)</span> is observed) distinguishes this factor model from regression problems. The factor analysis model can also be written in matrix notation, which allows for easier derivation of some of the following procedures and thus should be considered valuable as well.</p>
<p><span class="math display">\[
\underset{p \times 1}{\boldsymbol X}  = 
\underset{p \times 1}{\boldsymbol \mu} +
\underset{p \times m}{\boldsymbol L} \; \underset{m \times p}{\boldsymbol F} +
\underset{p \times 1}{\boldsymbol \epsilon}
\]</span></p>
<p><span class="math display">\[
\underset{p \times 1}{\boldsymbol X - \boldsymbol \mu}  = 
\underset{p \times m}{\boldsymbol L} \; \underset{m \times p}{\boldsymbol F} +
\underset{p \times 1}{\boldsymbol \epsilon}
\]</span></p>
<p><span class="math display">\[
\boldsymbol \Sigma = Cov(\boldsymbol X) = 
\underset{\;\\Communality}{\boldsymbol L \boldsymbol L^T} + 
\underset{\;\\Uniqueness}{\boldsymbol \Psi}
\]</span></p>
</div>
<div id="estimation" class="section level2">
<h2><span class="header-section-number">2.2</span> Estimation</h2>
<p>Work in Progress …</p>
<div id="principal-component-method" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Principal Component Method</h3>
</div>
<div id="principal-factor-solution" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Principal Factor Solution</h3>
</div>
<div id="maximum-likelihood-estimation" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Maximum Likelihood Estimation</h3>
</div>
</div>
<div id="rotation" class="section level2">
<h2><span class="header-section-number">2.3</span> Rotation</h2>
<p>Work in Progress …</p>
</div>
<div id="basic-factor-analysis-in-r" class="section level2">
<h2><span class="header-section-number">2.4</span> Basic Factor Analysis in R</h2>
<p>In R there are multiple implementations of factor analysis available. Each model variant and each implementation comes with its own strengths and drawbacks. A good starting point is the <code>factanal()</code> function that comes with the preinstalled <code>stats</code> package. However, more elaborate and flexible approaches are available for download (e.g. in the <code>psych</code> package). In this part we are focusing on the the factor analysis procedure that is implemented in the <code>factanal()</code> function, which performs maximum-likelihood factor analysis on a covariance, correlation or data matrix. For using <code>factanal()</code> four arguments are essential <code>x</code> to input the data, <code>factors</code> to specify the number of factors that should be used, <code>scores</code> to specify the method used to calculate the factor scores and <code>rotation</code> to specify the method for orthogonal or oblique rotation.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="factor-analysis.html#cb1-1"></a><span class="kw">factanal</span>(x,        <span class="co"># Data</span></span>
<span id="cb1-2"><a href="factor-analysis.html#cb1-2"></a>         factors,  <span class="co"># Number of factors</span></span>
<span id="cb1-3"><a href="factor-analysis.html#cb1-3"></a>         scores,   <span class="co"># Method to calculate factor scores</span></span>
<span id="cb1-4"><a href="factor-analysis.html#cb1-4"></a>         rotation) <span class="co"># Method for rotation</span></span></code></pre></div>
<p>While <code>x</code> and <code>factors</code> must be specified by the user the arguments <code>scores</code> and <code>rotation</code> use default values. Factor scores could be calculated either using Thompsons method (<code>scores = "regression"</code>), based on Bartlett’s weighted least-squares approach (<code>scores = "Bartlett"</code>) or not calculated at all (defaul: <code>scores = "none"</code>). Applying factor rotation can either be done using the default Varimax option (<code>rotation = "varimax"</code>) for orthogonal transformation or using <code>rotation = "Bartlett"</code> for an oblique transformation. Alternatively results can be obtained without applying a transformation using <code>rotation = "none"</code>.</p>
<div id="data-preparation-and-description" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Data Preparation and Description</h3>
<p>Lets get our hands dirty and apply what we learned. The following code loads some data that results from a questionnaire with 50 questions.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="factor-analysis.html#cb2-1"></a>q &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data/fa_questions.rds&quot;</span>)  <span class="co"># Questions asked</span></span>
<span id="cb2-2"><a href="factor-analysis.html#cb2-2"></a>d &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data/fa_sample.rds&quot;</span>)     <span class="co"># Response data</span></span></code></pre></div>
<p>The variable <code>q</code> contains the questions from the questionnaire (50 items) while <code>d</code> contains the actual responses. Respondents hat the option to answer each question using a 5-point Likert-Scale, that was labeled 1=Disagree, 3=Neutral, 5=Agree. However, the data is not pre-processed and needs to be thoroughly investigated and potentially cleaned up before it can be used for analytic procedures.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="factor-analysis.html#cb3-1"></a><span class="kw">head</span>(q, <span class="dt">n=</span><span class="dv">6</span>) <span class="co"># Show first 6 rows from the dataframe</span></span></code></pre></div>
<pre><code>##     Q coding                            question
## 1 Q01      P   I feel comfortable around people.
## 2 Q02      P             I have excellent ideas.
## 3 Q03      N                    I insult people.
## 4 Q04      P         I am the life of the party.
## 5 Q05      N   I do not have a good imagination.
## 6 Q06      P I sympathize with others&#39; feelings.</code></pre>
<p>The object <code>q</code> contains three variables (columns), the question ID <code>Q</code>, an indication if the question is positively (<code>coding == "P"</code>) or negatively (<code>coding == "N"</code>) formulated and the actual formulation of the item <code>question</code>. The responses are saved in object <code>d</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="factor-analysis.html#cb5-1"></a><span class="kw">head</span>(d, <span class="dt">n=</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>##   Q04 Q39 Q01 Q34 Q23 Q43 Q14 Q18 Q33 Q21 Q41 Q10 Q07 Q09 Q15 Q40 Q25 Q47 Q12
## 1   2   3   3   3   3   3   4   3   3   4   4   2   5   2   4   4   4   4   4
## 2   4   2   3   3   4   2   4   2   4   4   3   4   5   3   4   4   3   4   4
## 3   3   4   4   3   3   2   3   3   3   3   2   4   4   3   2   3   3   3   4
## 4   1   3   3   2   4   2   2   2   5   3   2   2   5   1   4   3   5   4   4
## 5   1   5   1   2   2   1   3   2   4   5   4   2   5   3   3   4   4   3   4
## 6   1   5   4   5   3   2   1   5   2   5   3   3   5   1   4   3   4   4   2
##   Q36 Q48 Q20 Q03 Q06 Q49 Q26 Q27 Q31 Q29 Q22 Q32 Q24 Q08 Q35 Q37 Q38 Q45 Q19
## 1   5   2   4   1   4   2   4   2   3   4   4   4   3   4   3   3   4   4   2
## 2   3   5   4   3   4   2   4   2   4   4   3   4   5   4   4   2   5   1   3
## 3   3   1   4   2   4   3   3   2   4   3   3   2   2   4   2   4   3   3   2
## 4   4   2   4   2   4   1   5   2   4   4   4   4   1   4   1   4   1   4   2
## 5   3   4   4   3   4   2   5   2   4   5   3   5   2   5   1   4   1   4   4
## 6   4   1   4   2   5   2   5   3   4   4   3   2   4   4   3   3   2   4   2
##   Q42 Q46 Q28 Q13 Q44 Q16 Q02 Q05 Q11 Q50 Q17 Q30 IPC testelapse country
## 1   4   4   4   2   5   2   4   2   4   5   4   4   1         97      DE
## 2   2   3   4   3   4   2   3   4   3   4   4   4   1        162      DE
## 3   3   4   5   1   4   2   4   2   4   2   4   4   1        428      DE
## 4   4   4   5   1   5   1   4   2   5   5   5   3   1        156      DE
## 5   5   5   4   1   5   1   5   1   5   5   3   5   2        221      DE
## 6   3   3   5   2   3   3   3   3   5   5   4   4   1        140      DE</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="factor-analysis.html#cb7-1"></a><span class="kw">dim</span>(d)         <span class="co"># Dimensions of the data matrix</span></span></code></pre></div>
<pre><code>## [1] 14095    53</code></pre>
<p>In total we have 14095 observations and 53 variables in the dataframe. The first 50 columns represent the responses to the items introduced above. The remaining three variables (IPC, testelapse, country) provide metadata and some technical information, which can be used to perform plausibility checks and cleanup the data.</p>
<ul>
<li><code>IPC</code>: Is an abbreviation for IP (Internet Protocol Adress) Count and lists the number of records from the user’s IP address in the dataset. For max cleanliness is is recommended to only use records where this value is 1. It should, however, be noted that high values can have multiple causes and do no necessarily represent abusive usage of the survey service. They can be because of shared networks (e.g. entire universities) or multiple submissions.</li>
<li><code>testelapse</code>: Is the time in seconds spent on the page with the survey questions.</li>
<li><code>country</code>: Indicates the country of the responded, but is determined by technical information and was <em>not asked as a question</em>.</li>
</ul>
<details>
<p><summary>50 Items - Click to expand!</summary></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="factor-analysis.html#cb9-1"></a><span class="kw">rnorm</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1]  1.4513333 -0.8950159 -0.8152918 -0.2511007 -0.7293953</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="factor-analysis.html#cb11-1"></a><span class="co">#kable_paper(kbl(items), &quot;hover&quot;, full_width = F)</span></span></code></pre></div>
</details>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="factor-analysis.html#cb12-1"></a>d_cleaned &lt;-<span class="st"> </span><span class="kw">na.omit</span>(d) <span class="co"># Remove rows with missing values.</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="factor-analysis.html#cb13-1"></a>d_small &lt;-<span class="st"> </span>d_cleaned[ ,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]</span></code></pre></div>
</div>
<div id="selecting-numbers-of-factors" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Selecting numbers of Factors</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="factor-analysis.html#cb14-1"></a><span class="co"># Calculate Correlation Matrix, Eigenvalues &amp; Proportion of Variance</span></span>
<span id="cb14-2"><a href="factor-analysis.html#cb14-2"></a>R &lt;-<span class="st"> </span><span class="kw">cor</span>(d_small)</span>
<span id="cb14-3"><a href="factor-analysis.html#cb14-3"></a>eigval &lt;-<span class="st"> </span><span class="kw">eigen</span>(R)<span class="op">$</span>values</span>
<span id="cb14-4"><a href="factor-analysis.html#cb14-4"></a>proptotvar &lt;-<span class="st"> </span>eigval <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(eigval)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="factor-analysis.html#cb15-1"></a><span class="co"># Screeplot</span></span>
<span id="cb15-2"><a href="factor-analysis.html#cb15-2"></a><span class="kw">plot</span>(eigval, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Eigenvalue&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Index&quot;</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb15-3"><a href="factor-analysis.html#cb15-3"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(eigval))</span>
<span id="cb15-4"><a href="factor-analysis.html#cb15-4"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">1</span>, <span class="dt">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="bchwtz-smod_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="factor-analysis.html#cb16-1"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Eigenvalue =</span> eigval, </span>
<span id="cb16-2"><a href="factor-analysis.html#cb16-2"></a>                 <span class="dt">Var=</span>proptotvar, </span>
<span id="cb16-3"><a href="factor-analysis.html#cb16-3"></a>                 <span class="dt">sumVar=</span><span class="kw">cumsum</span>(proptotvar))</span>
<span id="cb16-4"><a href="factor-analysis.html#cb16-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(df, <span class="dt">digits=</span><span class="dv">4</span>, <span class="dt">booktabs=</span>T)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
Eigenvalue
</th>
<th style="text-align:right;">
Var
</th>
<th style="text-align:right;">
sumVar
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.5200
</td>
<td style="text-align:right;">
0.5867
</td>
<td style="text-align:right;">
0.5867
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7488
</td>
<td style="text-align:right;">
0.1248
</td>
<td style="text-align:right;">
0.7115
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5207
</td>
<td style="text-align:right;">
0.0868
</td>
<td style="text-align:right;">
0.7983
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4586
</td>
<td style="text-align:right;">
0.0764
</td>
<td style="text-align:right;">
0.8747
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4120
</td>
<td style="text-align:right;">
0.0687
</td>
<td style="text-align:right;">
0.9434
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3399
</td>
<td style="text-align:right;">
0.0566
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
</tbody>
</table>
</div>
<div id="applying-factor-analysis" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Applying Factor Analysis</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="factor-analysis.html#cb17-1"></a>fa_none &lt;-<span class="st"> </span><span class="kw">factanal</span>(d_small , <span class="dt">factors =</span> <span class="dv">2</span>, <span class="dt">rotation =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb17-2"><a href="factor-analysis.html#cb17-2"></a>fa_varimax &lt;-<span class="st"> </span><span class="kw">factanal</span>(d_small , <span class="dt">factors =</span> <span class="dv">2</span>, <span class="dt">rotation =</span> <span class="st">&quot;varimax&quot;</span>)</span>
<span id="cb17-3"><a href="factor-analysis.html#cb17-3"></a>fa_promax &lt;-<span class="st"> </span><span class="kw">factanal</span>(d_small, <span class="dt">factors =</span> <span class="dv">2</span>, <span class="dt">rotation =</span> <span class="st">&quot;promax&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="factor-analysis.html#cb18-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb18-2"><a href="factor-analysis.html#cb18-2"></a><span class="kw">plot</span>(fa_none<span class="op">$</span>loadings[,<span class="dv">1</span>], </span>
<span id="cb18-3"><a href="factor-analysis.html#cb18-3"></a>     fa_none<span class="op">$</span>loadings[,<span class="dv">2</span>],</span>
<span id="cb18-4"><a href="factor-analysis.html#cb18-4"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Factor 1&quot;</span>, </span>
<span id="cb18-5"><a href="factor-analysis.html#cb18-5"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Factor 2&quot;</span>, </span>
<span id="cb18-6"><a href="factor-analysis.html#cb18-6"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb18-7"><a href="factor-analysis.html#cb18-7"></a>     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb18-8"><a href="factor-analysis.html#cb18-8"></a>     <span class="dt">main =</span> <span class="st">&quot;No rotation&quot;</span>)</span>
<span id="cb18-9"><a href="factor-analysis.html#cb18-9"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb18-10"><a href="factor-analysis.html#cb18-10"></a></span>
<span id="cb18-11"><a href="factor-analysis.html#cb18-11"></a><span class="kw">plot</span>(fa_varimax<span class="op">$</span>loadings[,<span class="dv">1</span>], </span>
<span id="cb18-12"><a href="factor-analysis.html#cb18-12"></a>     fa_varimax<span class="op">$</span>loadings[,<span class="dv">2</span>],</span>
<span id="cb18-13"><a href="factor-analysis.html#cb18-13"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Factor 1&quot;</span>, </span>
<span id="cb18-14"><a href="factor-analysis.html#cb18-14"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Factor 2&quot;</span>, </span>
<span id="cb18-15"><a href="factor-analysis.html#cb18-15"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb18-16"><a href="factor-analysis.html#cb18-16"></a>     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb18-17"><a href="factor-analysis.html#cb18-17"></a>     <span class="dt">main =</span> <span class="st">&quot;Varimax rotation&quot;</span>)</span>
<span id="cb18-18"><a href="factor-analysis.html#cb18-18"></a></span>
<span id="cb18-19"><a href="factor-analysis.html#cb18-19"></a><span class="kw">text</span>(fa_varimax<span class="op">$</span>loadings[,<span class="dv">1</span>]<span class="op">-</span><span class="fl">0.08</span>, </span>
<span id="cb18-20"><a href="factor-analysis.html#cb18-20"></a>     fa_varimax<span class="op">$</span>loadings[,<span class="dv">2</span>]<span class="op">+</span><span class="fl">0.08</span>,</span>
<span id="cb18-21"><a href="factor-analysis.html#cb18-21"></a>     <span class="kw">colnames</span>(d_small),</span>
<span id="cb18-22"><a href="factor-analysis.html#cb18-22"></a>     <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb18-23"><a href="factor-analysis.html#cb18-23"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb18-24"><a href="factor-analysis.html#cb18-24"></a></span>
<span id="cb18-25"><a href="factor-analysis.html#cb18-25"></a><span class="kw">plot</span>(fa_promax<span class="op">$</span>loadings[,<span class="dv">1</span>], </span>
<span id="cb18-26"><a href="factor-analysis.html#cb18-26"></a>     fa_promax<span class="op">$</span>loadings[,<span class="dv">2</span>],</span>
<span id="cb18-27"><a href="factor-analysis.html#cb18-27"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Factor 1&quot;</span>, </span>
<span id="cb18-28"><a href="factor-analysis.html#cb18-28"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Factor 2&quot;</span>,</span>
<span id="cb18-29"><a href="factor-analysis.html#cb18-29"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb18-30"><a href="factor-analysis.html#cb18-30"></a>     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb18-31"><a href="factor-analysis.html#cb18-31"></a>     <span class="dt">main =</span> <span class="st">&quot;Promax rotation&quot;</span>)</span>
<span id="cb18-32"><a href="factor-analysis.html#cb18-32"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;darkgrey&quot;</span>)</span></code></pre></div>
<p><img src="bchwtz-smod_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="interpreting-the-factors" class="section level3">
<h3><span class="header-section-number">2.4.4</span> Interpreting the Factors</h3>
</div>
</div>
<div id="exercises" class="section level2 unnumbered">
<h2>Exercises</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="factor-analysis.html#cb19-1"></a>ski &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">skiers =</span> <span class="kw">paste0</span>(<span class="st">&quot;S&quot;</span>, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)),</span>
<span id="cb19-2"><a href="factor-analysis.html#cb19-2"></a>                  <span class="dt">cost =</span> <span class="kw">c</span>(<span class="dv">32</span>, <span class="dv">61</span>, <span class="dv">59</span>, <span class="dv">36</span>, <span class="dv">62</span>),</span>
<span id="cb19-3"><a href="factor-analysis.html#cb19-3"></a>                  <span class="dt">lift =</span> <span class="kw">c</span>(<span class="dv">64</span>, <span class="dv">37</span>, <span class="dv">40</span>, <span class="dv">62</span>, <span class="dv">46</span>),</span>
<span id="cb19-4"><a href="factor-analysis.html#cb19-4"></a>                  <span class="dt">depth =</span> <span class="kw">c</span>(<span class="dv">65</span>, <span class="dv">62</span>, <span class="dv">45</span>, <span class="dv">34</span>, <span class="dv">43</span>),</span>
<span id="cb19-5"><a href="factor-analysis.html#cb19-5"></a>                  <span class="dt">powder =</span> <span class="kw">c</span>(<span class="dv">67</span>, <span class="dv">65</span>, <span class="dv">43</span>, <span class="dv">35</span>, <span class="dv">40</span>))</span></code></pre></div>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="system-info.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-factoranalysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bchwtz-smod.pdf", "bchwtz-smod.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
